subject = f"Error Had Been Detected in {data_dict.get('ObjectType', None)}!"

lines = []

# Title (not padded)
lines.append('<h2 style="color:red; margin:0;">Error Had Been Detected, Check information below:</h2>')

# Start padded block
lines.append('<div style="padding-left: 20px;">')

# Add h3 fields inside the padded div
fields = {
    "Module Name": data_dict.get("ObjectType"),
    "Action Type": data_dict.get("ActionType"),
    "sp": data_dict.get("sp"),
    "ScheduleID": data_dict.get("ScheduleID"),
    "Module": data_dict.get("Module"),
    "Import System": data_dict.get("ImportSystem"),
    "Source Server": data_dict.get("SourceServer"),
    "Destination Server": data_dict.get("DestinationServer"),
    "Desination DB": data_dict.get("DesinationDB"),
    "Desination Scheda": data_dict.get("DesinationScheda"),
    "Desination Object": data_dict.get("DestinationObject"),
    "Error Number": data_dict.get("ErrorNumber"),
    "Error Severity": data_dict.get("ErrorSeverity"),
    "Error State": data_dict.get("ErrorState"),
    "Error Procedure": data_dict.get("ErrorProcedure"),
    "Error Line": data_dict.get("ErrorLine"),
    "Error Message": data_dict.get("ErrorMessage"),
}

for label, value in fields.items():
    lines.append(f'<h3 style="color:red; margin:4px 0;">{label}: {value}</h3>')

# Close padded block
lines.append('</div>')

return "\n".join(lines), subject
