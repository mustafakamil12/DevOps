def drop_unresponsive_nodes(filter_results, index_uuid, *, case_insensitive=True):
    # Build set of FQDNs that failed (payload is None)
    if case_insensitive:
        bad = {fqdn.casefold() for fqdn, _, payload in filter_results if payload is None}
        return [t for t in index_uuid if t[0].casefold() not in bad]
    else:
        bad = {fqdn for fqdn, _, payload in filter_results if payload is None}
        return [t for t in index_uuid if t[0] not in bad]
