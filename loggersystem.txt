import logging
from logging.handlers import SysLogHandler

def configure_logging(debug=False, critical=False):
    # Decide log level
    if debug:
        log_level = logging.DEBUG
    elif critical:
        log_level = logging.CRITICAL
    else:
        log_level = logging.INFO

    fmt = logging.Formatter(
        '[%(levelname)s] [%(asctime)s] [%(name)s]: [%(module)s] [%(funcName)s] |%(lineno)4d : %(message)s',
        datefmt='%Y-%m-%d %H:%M:%S'
    )

    # Use ROOT so every module logger propagates here
    root = logging.getLogger()
    root.setLevel(log_level)

    # Prevent duplicates if configure_logging is called again
    root.handlers.clear()

    # Console
    console = logging.StreamHandler()
    console.setLevel(log_level)
    console.setFormatter(fmt)
    root.addHandler(console)

    # VRLI Syslog
    syslog_handler = SysLogHandler(address=('vrli-mwdc-vsi.nam.nsroot.net', 514))
    syslog_handler.setLevel(log_level)
    syslog_handler.setFormatter(fmt)
    root.addHandler(syslog_handler)

    # Optional: stop noisy libraries
    logging.getLogger('urllib3.connectionpool').setLevel(logging.WARNING)
    logging.getLogger('httpx').setLevel(logging.WARNING)
    logging.getLogger('httpcore').setLevel(logging.WARNING)
    logging.getLogger('h11').setLevel(logging.WARNING)
