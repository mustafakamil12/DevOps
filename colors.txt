# Send Message with Callback
future = producer.send(topic, b'Hello Kafka!')
future.add_callback(on_success)
future.add_errback(on_error)

# Send to a particular partition
future_partition = producer.send(topic, b'Hello Kafka!', partition=0)
future_partition.add_callback(on_success)
future_partition.add_errback(on_error)

# Ensure messages are sent before closing
producer.flush()
producer.close()
